<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Exam In Session</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.2.1/flowbite.min.css" rel="stylesheet"/>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body { font-family: 'Poppins', sans-serif; }
    .option-selected { border: 2px solid #2563EB !important; background: #DBEAFE !important; }
    .focus-ring:focus { outline: 2px solid #2563EB; outline-offset: 2px; }
    .floating-footer { box-shadow: 0 6px 32px 0 rgba(30,41,59,0.07), 0 1.5px 4px 0 rgba(0,0,0,0.03); }
    .mathjax { font-size: 1.12em; }
    .card { transition: box-shadow 0.18s; }
    .card:hover { box-shadow: 0 10px 16px rgba(79,70,229,0.14); }
    @media (min-width: 900px) {
      .main-content-flex { flex-direction: row; align-items: flex-start; }
      .sidebar { min-width: 320px; max-width: 350px; margin-right: 2rem; }
      .exam-section { flex: 1 1 0; }
    }
    @media (max-width: 900px) {
      .main-content-flex { flex-direction: column; }
      .sidebar { width: 100%; max-width: 100%; margin-bottom: 2rem; }
      .exam-section { width: 100%; }
    }
    .feedback-outer {
      background: linear-gradient(135deg, #eef2ff 0%, #dbeafe 100%);
      border-radius: 1.5rem;
      box-shadow: 0 4px 32px rgba(79,70,229,0.09);
      padding: 2.5rem 2rem 2rem 2rem;
      max-width: 480px;
      margin: 2rem auto 1.5rem auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      border: 2px solid #c7d2fe;
    }
    .feedback-score {
      font-size: 2.7rem;
      font-weight: 800;
      background: linear-gradient(90deg, #2563eb, #818cf8);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-fill-color: transparent;
      margin-bottom: 0.6rem;
    }
    .feedback-badge {
      font-size: 1.18rem;
      font-weight: 600;
      padding: 0.4em 1.2em;
      border-radius: 9999px;
      background: #d1fae5;
      color: #047857;
      margin-bottom: 1.3rem;
      box-shadow: 0 2px 6px rgba(16,185,129,0.08);
    }
    .feedback-list {
      margin-top: 1.2rem;
      margin-bottom: 0.5rem;
      text-align: left;
      color: #374151;
      font-size: 1.05rem;
      padding-left: 1.5rem;
    }
    .feedback-title {
      font-size: 1.25rem;
      font-weight: 700;
      color: #6366f1;
      margin-bottom: 0.36em;
      letter-spacing: 1px;
      text-align: center;
    }
    .feedback-success {
      background: #d1fae5;
      color: #065f46;
    }
    .feedback-fail {
      background: #fef2f2;
      color: #b91c1c;
    }
    /* Notification & confirm modals */
    #notificationModal, #confirmModal {
      transition: opacity 0.2s;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-white min-h-screen flex flex-col">

  <!-- Notification Modal -->
  <div id="notificationModal" class="fixed inset-0 z-[99] flex items-center justify-center bg-black/30 hidden">
    <div class="bg-white rounded-lg shadow-lg px-6 py-5 text-center max-w-sm w-full border border-gray-300">
      <div id="notificationIcon" class="mx-auto mb-3 text-4xl"></div>
      <div id="notificationText" class="text-lg font-semibold text-gray-800 mb-2"></div>
      <button id="notificationCloseBtn" class="mt-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition">Close</button>
    </div>
  </div>
  <!-- Confirmation Modal -->
  <div id="confirmModal" class="fixed inset-0 z-[100] flex items-center justify-center bg-black/30 hidden">
    <div class="bg-white rounded-lg shadow-lg px-6 py-5 text-center max-w-sm w-full border border-gray-300">
      <div id="confirmModalText" class="text-lg font-semibold text-gray-800 mb-2"></div>
      <div class="mt-3 flex gap-4 justify-center">
        <button id="confirmModalYes" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition">Yes</button>
        <button id="confirmModalNo" class="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition">No</button>
      </div>
    </div>
  </div>

  <!-- TOP BAR -->
  <header class="sticky top-0 z-40 w-full bg-white/90 backdrop-blur shadow flex flex-col md:flex-row md:items-center md:justify-between px-4 py-3">
    <div class="flex items-center gap-3">
      <img id="userAvatar" src="https://i.pravatar.cc/56" class="w-12 h-12 rounded-full border-2 border-blue-500 shadow" alt="User profile">
      <div>
        <div id="userFullname" class="font-semibold text-gray-800">Student</div>
        <div id="userMeta" class="text-xs text-gray-500"></div>
      </div>
    </div>
    <div class="flex-1 flex flex-col items-center py-2">
      <div id="examTitle" class="text-lg font-bold text-blue-700">Exam Session</div>
      <div id="examMeta" class="text-xs text-gray-500 mt-1"></div>
    </div>
    <div class="flex flex-col items-end gap-1">
      <div class="flex items-center gap-2">
        <span class="text-xs text-gray-500">Time Left:</span>
        <span id="timer" class="font-mono text-base font-bold text-red-600">--:--:--</span>
        <span class="rounded bg-green-100 text-green-700 text-xs px-2 py-0.5 ml-2" id="autoSave">Auto-saved</span>
      </div>
      <div class="flex items-center gap-2 mt-1">
        <div class="w-36 bg-gray-200 rounded-full h-2" aria-label="progress bar" role="progressbar">
          <div id="progressBar" class="bg-blue-500 h-2 rounded-full" style="width: 0%"></div>
        </div>
        <span class="text-xs text-gray-500 ml-1"><span id="answeredCount">0</span>/<span id="totalQuestions">0</span></span>
      </div>
    </div>
  </header>

  <main class="container mx-auto flex main-content-flex justify-center px-2 py-6 gap-4">

    <!-- SIDEBAR: Configuration -->
    <section class="sidebar card bg-white rounded-2xl shadow-xl p-6 md:p-8 border border-blue-100 mb-6">
      <h3 class="text-xl font-semibold text-indigo-900 mb-2">Configure Your Practice Session</h3>
      <form id="practice-config-form" class="practice-form grid grid-cols-1 gap-3">
        <div>
          <label for="subject" class="text-sm font-medium text-gray-700">Subject</label>
          <select id="subject" name="subject" required class="mt-1 block w-full p-2 border border-gray-300 rounded-lg">
            <option value="">Select Subject</option>
            <option value="Mathematics">Mathematics</option>
            <option value="Physics">Physics</option>
            <option value="Chemistry">Chemistry</option>
            <option value="Biology">Biology</option>
            <option value="Computer Science">Computer Science</option>
          </select>
        </div>
        <div>
          <label for="courseCode" class="text-sm font-medium text-gray-700">Course Code</label>
          <select id="courseCode" name="courseCode" required class="mt-1 block w-full p-2 border border-gray-300 rounded-lg">
            <option value="">Select Course Code</option>
          </select>
        </div>
        <div>
          <label for="year" class="text-sm font-medium text-gray-700">Year</label>
          <select id="year" name="year" required class="mt-1 block w-full p-2 border border-gray-300 rounded-lg">
            <option value="2024-2025">2024-2025</option>
          <option value="2023-2024">2023-2024</option>
          <option value="2022-2023">2022-2023</option>
        <option value="2021-2022">2021-2022</option>
          <option value="2020-2021">2020-2021</option>
          <option value="2019-2020">2019-2020</option>
          <option value="2018-2019">2018-2019</option>
          <option value="2017-2018">2017-2018</option>
        </select>
        </div>
        <div>
          <label for="questions" class="text-sm font-medium text-gray-700">Total Questions</label>
          <select id="questions" name="count" required class="mt-1 block w-full p-2 border border-gray-300 rounded-lg">
            <option value="">Select Number of Questions</option>
            <option value="10">10</option>
            <option value="20">20</option>
            <option value="30">30</option>
            <option value="40">40</option>
            <option value="50">50</option>
          </select>
        </div>
        <div>
          <label for="time" class="text-sm font-medium text-gray-700">Time (Minutes)</label>
          <select id="time" name="time" required class="mt-1 block w-full p-2 border border-gray-300 rounded-lg">
            <option value="">Select Time</option>
            <option value="30">30</option>
            <option value="40">40</option>
            <option value="60">60</option>
            <option value="90">90</option>
            <option value="120">120</option>
          </select>
        </div>
        <div>
          <label for="topic" class="text-sm font-medium text-gray-700">Topic (optional)</label>
          <input id="topic" name="topic" type="text" class="mt-1 block w-full p-2 border border-gray-300 rounded-lg" placeholder="e.g., Algebra">
        </div>
        <button type="submit" class="mt-4 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 glow-button w-full font-semibold">
          Start Practice
        </button>
      </form>
    </section>

    <!-- EXAM CONTENT -->
    <section class="exam-section w-full flex flex-col items-center">
      <div class="w-full max-w-2xl bg-white rounded-2xl shadow-xl p-6 md:p-8 border border-blue-100" id="examCard" aria-live="polite">

        <div class="flex items-center justify-between mb-4">
          <div class="flex items-center gap-2">
            <span class="text-base font-bold text-blue-600 bg-blue-100 px-3 py-1 rounded-full shadow" id="questionNumberTitle">
              Q --/--
            </span>
            <span id="displayCourseCode" class="ml-2 text-md rounded px-2 py-1 bg-indigo-50 text-indigo-700 font-semibold"></span>
            <button onclick="flagQuestion()" id="flagBtn" aria-pressed="false" aria-label="Flag question"
              class="ml-2 flex items-center gap-1 px-2 py-0.5 rounded text-xs border border-yellow-400 bg-yellow-50 text-yellow-700 hover:bg-yellow-100 focus-ring">
              <svg class="w-4 h-4 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M4 4v16M4 4h16l-2.5 5 2.5 5H4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
              Flag
            </button>
          </div>
          <span id="statusBadge" class="px-2 py-0.5 text-xs rounded bg-gray-100 text-gray-600">Not Answered</span>
        </div>

        <!-- Question Navigation Grid (inline, accessible) -->
        <nav aria-label="Question navigation" class="mb-4 flex flex-wrap gap-2 justify-center">
          <div id="questionNavGrid" class="flex flex-wrap gap-2"></div>
        </nav>

        <!-- Question Image (if present) -->
        <div id="questionImageContainer" class="mb-2" style="display:none;">
          <img id="questionImage" alt="Question illustration" class="rounded-lg mx-auto max-h-52"/>
        </div>
        <!-- Question Text (supports math) -->
        <h2 id="questionText" class="text-lg font-semibold mb-3 text-gray-900 mathjax"></h2>
        <!-- Options -->
        <form id="optionsForm" class="grid gap-3" aria-labelledby="questionText"></form>

        <!-- Save, Next, Skip -->
        <div class="flex justify-between items-center mt-6 gap-2">
          <button onclick="skipQuestion()" id="skipBtn" class="py-2 px-4 rounded-lg bg-yellow-50 text-yellow-700 border border-yellow-300 hover:bg-yellow-100 font-semibold transition focus-ring" type="button">Skip</button>
          <button onclick="saveAnswer()" id="saveNextBtn" class="py-2 px-6 rounded-lg bg-blue-600 hover:bg-blue-700 text-white font-semibold shadow transition focus-ring" type="button" accesskey="n">Save & Next</button>
        </div>
      </div>
      <div id="feedbackBox" style="display:none;"></div>
    </section>
  </main>

  <!-- FOOTER NAVIGATION -->
  <footer class="sticky bottom-0 w-full z-50 flex justify-center" aria-label="Exam navigation">
    <div class="floating-footer bg-white/95 border-t border-blue-100 rounded-t-2xl shadow-lg max-w-3xl w-full mx-auto px-3 py-2 flex items-center justify-between gap-2">
      <button onclick="prevQuestion()" id="prevBtn" class="flex flex-col items-center text-gray-600 hover:text-blue-600 transition focus-ring" aria-label="Previous question" accesskey="p">
        <svg class="w-6 h-6 mb-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M15 19l-7-7 7-7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        <span class="text-xs">Prev (P)</span>
      </button>
      <button onclick="nextQuestion()" id="nextBtn" class="flex flex-col items-center text-gray-600 hover:text-blue-600 transition focus-ring" aria-label="Next question" accesskey="x">
        <svg class="w-6 h-6 mb-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M9 5l7 7-7 7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        <span class="text-xs">Next (X)</span>
      </button>
      <button onclick="submitExam()" id="submitBtn" class="py-2 px-6 rounded-lg bg-green-600 hover:bg-green-700 text-white font-bold shadow-md transition focus-ring" aria-label="Submit exam">
  Submit Exam
</button>    </div>
  </footer>

  <script src="tpp.js">
  </script>
</body>
</html>
